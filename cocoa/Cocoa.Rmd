---
title: "Cocoa Dataset Analysis"
author: "Chisimdiri"
date: "12/21/2021"
output: html_document
---

This is my first analysis using R Studio. This dataset can be found on kaggle.com, it is a cocoa datset. I will be using this dataset to bring out meaningful insights to help a chocolate making company make data driven decisions and improve their income.
These are some of the questions my analysis would answer.
* Where are the best cocoa beans grown?
* Which countries produce the highest-rated bars?
* What’s the relationship between cocoa solids percentage and rating?


```{r load dataset to R studio}
setwd("C:/Users/Chisim/Desktop/choco")
getwd()
cocoa_df <- read.csv("flavors_of_cacao.csv", header = TRUE, sep = ",")
```

```{r view dataset}
View(cocoa_df)
str(cocoa_df)
```

```{r rename column & cleaning}
cocoa_df %>% 
  rename(Company = CompanyÂ...Maker.if.known.)
clean_names(cocoa_df)
```
```{r selecting useful rows for analysis}
cocoa_df2 <- cocoa_df %>% 
  select(CompanyÂ...Maker.if.known., Company.Location, Rating, Cocoa.Percent, Specific.Bean.Origin.or.Bar.Name,Broad.Bean.Origin)
```

```{r view newly created table}
View(cocoa_df2)
str(cocoa_df2)
```

```{r average ratings for cocoa}
cocoa_df2 %>%
  summarize(mean_rating = mean(Rating))
```

From the The originator of this dataset on Kaggle he states that Cocoa with ratings less than 3.0 are termed to be unsatisfactory so we would only need cocoa with a rating of 3.0 and above, also the company needs cocoa percentage of 70% and above to make darker chocolates, so some filtering will need to be done. 
```{r filter cocoa ratings and percentage }
cocoa_df3 <- cocoa_df2 %>% 
  rename(Company.Name = CompanyÂ...Maker.if.known., Bean_country_origin = Broad.Bean.Origin )%>%
  filter(Rating >= '3.0' & Cocoa.Percent >= '70%' ) %>%
  arrange(Rating, Cocoa.Percent)
View(cocoa_df3)
```
### Relationship Between Cocoa Percentage and Rating
```{r Chart Showing Relationship Between Percentage and Rating}
ggplot(data = cocoa_df3) + geom_line(mapping = aes(x = Cocoa.Percent, y = Rating)) + labs(title = 'Relationship Between Percentage & Rating')
```
### The Company that produces the highest rated seeds
```{r Bar chart showing Company Locations with Highest Rated Bars}
ggplot(data = cocoa_df3) + geom_bar(mapping = aes(x = Company.Location, fill = Rating)) + labs(title = "Countries with Highest Rated Bars")
```
### Graph showing where the best cocoa seeds are grown
```{r}
ggplot(data = cocoa_df3) + geom_bar(mapping = aes(x = Bean_country_origin, fill = Rating)) + labs(title = "The best cocoa beans by location")
```

